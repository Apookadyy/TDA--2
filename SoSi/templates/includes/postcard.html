<div class="card mb-3">
  <div class="card-body">
    <div class="d-flex">
      <div class="me-3">
        {% if post.author.profile.avatar %}
          <img src="{{ post.author.profile.avatar.url }}" class="rounded-circle" width="50" height="50">
        {% else %}
          <div class="bg-secondary rounded-circle" style="width:50px;height:50px;"></div>
        {% endif %}
      </div>

      <div style="flex:1;">
        <h6 class="mb-0">
          {{ post.author.username }}
          <small class="text-muted">Â· {{ post.created_at|date:"M d, Y H:i" }}</small>
        </h6>

        <p class="mb-1">{{ post.content|linebreaks }}</p>

        {% if post.image %}
          <img src="{{ post.image.url }}" class="img-fluid mb-2" style="max-height:400px;">
        {% endif %}

        <div>
          <!-- Comments -->
          <a class="btn btn-sm btn-outline-primary" href="{% url 'SoSi:post_detail' post.pk %}">
            Comments ({{ post.comments.count }})
          </a>

          <!-- Like / Unlike -->
          <form style="display:inline" method="post" action="{% url 'SoSi:post_like' post.pk %}">
            {% csrf_token %}
            <button class="btn btn-sm btn-outline-danger" type="submit">
              {% if post.is_liked %}
                Unlike
              {% else %}
                Like
              {% endif %}
              ({{ post.total_likes }})
            </button>
          </form>

          <!-- Edit / Delete (only for author) -->
          {% if user == post.author %}
            <a class="btn btn-sm btn-outline-secondary" href="{% url 'SoSi:post_edit' post.pk %}">Edit</a>

            <form method="post" action="{% url 'SoSi:post_delete' post.pk %}" style="display:inline;">
              {% csrf_token %}
              <button class="btn btn-sm btn-outline-danger" type="submit">Delete</button>
            </form>
          {% endif %}
        </div>
      </div>
    </div>
  </div>
</div>
